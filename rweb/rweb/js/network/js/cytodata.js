//var data = '"","V1","V2","V3"#"1",1,1,0.562687581446862#"2",1,2,0.00757735462338721#"3",1,3,0.00675650767630923#"4",1,4,0.00630700579404336#"5",1,5,0.00554786325651631#"6",1,6,0.00554859786704334#"7",1,7,0.00415008136803245#"8",1,8,0.00497834198650298#"9",1,9,0.00582645746147927#"10",1,10,0.00589100146433865#"11",1,11,0.00572807221958982#"12",1,12,0.00641936438569972#"13",1,13,0.00648799793441353#"14",1,14,0.00526287632599694#"15",1,15,0.00523104924880415#"16",1,16,0.00690829177660257#"17",1,17,0.00680273496060778#"18",1,18,0.00663772329133235#"19",1,19,0.00608776892894252#"20",1,20,0.0059598457697213#"21",2,1,0.00757735462338721#"22",2,2,0.564507965826637#"23",2,3,0.00594139751574375#"24",2,4,0.00651157129554366#"25",2,5,0.00577616679827122#"26",2,6,0.00556370649726868#"27",2,7,0.00497394864111234#"28",2,8,0.00521904171401992#"29",2,9,0.00536353719373618#"30",2,10,0.00629118507647465#"31",2,11,0.0070409834165039#"32",2,12,0.00510248643432252#"33",2,13,0.0044863778580582#"34",2,14,0.00529113689411792#"35",2,15,0.00615804943339696#"36",2,16,0.00539996539466804#"37",2,17,0.00702569976095601#"38",2,18,0.00534836828122324#"39",2,19,0.00584183639340433#"40",2,20,0.00520856029992233#"41",3,1,0.00675650767630923#"42",3,2,0.00594139751574375#"43",3,3,0.56725219252189#"44",3,4,0.00650725286507919#"45",3,5,0.00578235990905218#"46",3,6,0.00573371439985482#"47",3,7,0.00405836503482443#"48",3,8,0.00715073759179177#"49",3,9,0.00642019893595246#"50",3,10,0.00466014827927899#"51",3,11,0.00469423049616126#"52",3,12,0.00483630837393035#"53",3,13,0.0043977957760559#"54",3,14,0.00748041958385064#"55",3,15,0.00533996855084099#"56",3,16,0.00807250681235683#"57",3,17,0.00550445530594407#"58",3,18,0.00549248002164443#"59",3,19,0.00538155792468196#"60",3,20,0.00526680603798109#"61",4,1,0.00630700579404336#"62",4,2,0.00651157129554366#"63",4,3,0.00650725286507919#"64",4,4,0.564509965694304#"65",4,5,0.00571551264476331#"66",4,6,0.00539465617236527#"67",4,7,0.00407458640820554#"68",4,8,0.00638579144480109#"69",4,9,0.00565848350230031#"70",4,10,0.00548193649800255#"71",4,11,0.005573819064894#"72",4,12,0.00482038903997611#"73",4,13,0.00429929333010399#"74",4,14,0.00631369160652129#"75",4,15,0.00741596192160409#"76",4,16,0.00556066339538624#"77",4,17,0.0062166283456556#"78",4,18,0.00530572334095195#"79",4,19,0.00631745602008732#"80",4,20,0.00478558272861992#"81",5,1,0.00554786325651631#"82",5,2,0.00577616679827122#"83",5,3,0.00578235990905218#"84",5,4,0.00571551264476331#"85",5,5,0.561043928953383#"86",5,6,0.00553289676121667#"87",5,7,0.00744978005485391#"88",5,8,0.0051371370504978#"89",5,9,0.0061714953904962#"90",5,10,0.00478580847067211#"91",5,11,0.00753648839432118#"92",5,12,0.00488153378203144#"93",5,13,0.0042024640859219#"94",5,14,0.00529300991484904#"95",5,15,0.00581177673228062#"96",5,16,0.00583870907050848#"97",5,17,0.00546167668674264#"98",5,18,0.00560272240827403#"99",5,19,0.00543160856538137#"100",5,20,0.00677752367062399#"101",6,1,0.00554859786704334#"102",6,2,0.00556370649726868#"103",6,3,0.00573371439985482#"104",6,4,0.00539465617236527#"105",6,5,0.00553289676121667#"106",6,6,0.567920065372839#"107",6,7,0.00474505656361859#"108",6,8,0.00605072906388752#"109",6,9,0.00829169303437154#"110",6,10,0.00505565472656513#"111",6,11,0.00489270622084844#"112",6,12,0.00429508195972136#"113",6,13,0.0042179301481526#"114",6,14,0.00607860751925512#"115",6,15,0.00517368246994515#"116",6,16,0.00667184612342144#"117",6,17,0.00585383482376052#"118",6,18,0.00468793399311048#"119",6,19,0.00535158333334281#"120",6,20,0.00478039580909167#"121",7,1,0.00415008136803245#"122",7,2,0.00497394864111234#"123",7,3,0.00405836503482443#"124",7,4,0.00407458640820554#"125",7,5,0.00744978005485391#"126",7,6,0.00474505656361859#"127",7,7,0.571662601339608#"128",7,8,0.00396417314485641#"129",7,9,0.00508627862135827#"130",7,10,0.0040502215941892#"131",7,11,0.00574439380226873#"132",7,12,0.00380141941241384#"133",7,13,0.00365880044408172#"134",7,14,0.00401269596622758#"135",7,15,0.00424704897283419#"136",7,16,0.00423779472173447#"137",7,17,0.00413291135580564#"138",7,18,0.00394584078937318#"139",7,19,0.00389477257197701#"140",7,20,0.00480303542777394#"141",8,1,0.00497834198650298#"142",8,2,0.00521904171401992#"143",8,3,0.00715073759179177#"144",8,4,0.00638579144480109#"145",8,5,0.0051371370504978#"146",8,6,0.00605072906388752#"147",8,7,0.00396417314485641#"148",8,8,0.559596088592654#"149",8,9,0.00738475770743735#"150",8,10,0.0052456514843301#"151",8,11,0.00455109342202254#"152",8,12,0.00434666776470915#"153",8,13,0.0044187562808161#"154",8,14,0.00780122076815565#"155",8,15,0.00590796898434972#"156",8,16,0.00592182833071866#"157",8,17,0.00551477651378671#"158",8,18,0.00496373549019806#"159",8,19,0.00663464396653689#"160",8,20,0.00439143299031698#"161",9,1,0.00582645746147927#"162",9,2,0.00536353719373618#"163",9,3,0.00642019893595246#"164",9,4,0.00565848350230031#"165",9,5,0.0061714953904962#"166",9,6,0.00829169303437154#"167",9,7,0.00508627862135827#"168",9,8,0.00738475770743735#"169",9,9,0.56452290813559#"170",9,10,0.00501579180227096#"171",9,11,0.00488158520952796#"172",9,12,0.00440644093473969#"173",9,13,0.00451651026787971#"174",9,14,0.00698178756968253#"175",9,15,0.00558130777264787#"176",9,16,0.00723293450586607#"177",9,17,0.00675993401280042#"178",9,18,0.00484122047641801#"179",9,19,0.00577312852018899#"180",9,20,0.00458547473487752#"181",10,1,0.00589100146433865#"182",10,2,0.00629118507647465#"183",10,3,0.00466014827927899#"184",10,4,0.00548193649800255#"185",10,5,0.00478580847067211#"186",10,6,0.00505565472656513#"187",10,7,0.0040502215941892#"188",10,8,0.0052456514843301#"189",10,9,0.00501579180227096#"190",10,10,0.557693597022377#"191",10,11,0.00800101176150254#"192",10,12,0.00473794868102197#"193",10,13,0.00452213904375575#"194",10,14,0.00478367360842533#"195",10,15,0.00568326120233471#"196",10,16,0.00543127883284286#"197",10,17,0.00606708350752808#"198",10,18,0.00545705648252963#"199",10,19,0.00670591233435198#"200",10,20,0.00540318329087312#"201",11,1,0.00572807221958982#"202",11,2,0.0070409834165039#"203",11,3,0.00469423049616126#"204",11,4,0.005573819064894#"205",11,5,0.00753648839432118#"206",11,6,0.00489270622084844#"207",11,7,0.00574439380226873#"208",11,8,0.00455109342202254#"209",11,9,0.00488158520952796#"210",11,10,0.00800101176150254#"211",11,11,0.562523843400463#"212",11,12,0.00629440403339885#"213",11,13,0.00471704728642957#"214",11,14,0.00447911668735128#"215",11,15,0.00757352572260519#"216",11,16,0.00549987082572344#"217",11,17,0.00567712245217064#"218",11,18,0.0052741142115203#"219",11,19,0.00532964961534256#"220",11,20,0.00631614004463337#"221",12,1,0.00641936438569972#"222",12,2,0.00510248643432252#"223",12,3,0.00483630837393035#"224",12,4,0.00482038903997611#"225",12,5,0.00488153378203144#"226",12,6,0.00429508195972136#"227",12,7,0.00380141941241384#"228",12,8,0.00434666776470915#"229",12,9,0.00440644093473969#"230",12,10,0.00473794868102197#"231",12,11,0.00629440403339885#"232",12,12,0.560032726758134#"233",12,13,0.00715441761852404#"234",12,14,0.00460346051422209#"235",12,15,0.00596608885557259#"236",12,16,0.00579723320211885#"237",12,17,0.00557427778144741#"238",12,18,0.00789055769152605#"239",12,19,0.00529659808580836#"240",12,20,0.00745975649943439#"241",13,1,0.00648799793441353#"242",13,2,0.0044863778580582#"243",13,3,0.0043977957760559#"244",13,4,0.00429929333010399#"245",13,5,0.0042024640859219#"246",13,6,0.0042179301481526#"247",13,7,0.00365880044408172#"248",13,8,0.0044187562808161#"249",13,9,0.00451651026787971#"250",13,10,0.00452213904375575#"251",13,11,0.00471704728642957#"252",13,12,0.00715441761852404#"253",13,13,0.559998305083043#"254",13,14,0.00441375722398492#"255",13,15,0.00439774877793142#"256",13,16,0.00587558417767342#"257",13,17,0.00537389056722877#"258",13,18,0.00598178778637268#"259",13,19,0.00483101105593876#"260",13,20,0.00496428406359646#"261",14,1,0.00526287632599694#"262",14,2,0.00529113689411792#"263",14,3,0.00748041958385064#"264",14,4,0.00631369160652129#"265",14,5,0.00529300991484904#"266",14,6,0.00607860751925512#"267",14,7,0.00401269596622758#"268",14,8,0.00780122076815565#"269",14,9,0.00698178756968253#"270",14,10,0.00478367360842533#"271",14,11,0.00447911668735128#"272",14,12,0.00460346051422209#"273",14,13,0.00441375722398492#"274",14,14,0.559072412997925#"275",14,15,0.00569818077242655#"276",14,16,0.00652526469954261#"277",14,17,0.00566208679067038#"278",14,18,0.00628033772764367#"279",14,19,0.00646437095019024#"280",14,20,0.00464964617483324#"281",15,1,0.00523104924880415#"282",15,2,0.00615804943339696#"283",15,3,0.00533996855084099#"284",15,4,0.00741596192160409#"285",15,5,0.00581177673228062#"286",15,6,0.00517368246994515#"287",15,7,0.00424704897283419#"288",15,8,0.00590796898434972#"289",15,9,0.00558130777264787#"290",15,10,0.00568326120233471#"291",15,11,0.00757352572260519#"292",15,12,0.00596608885557259#"293",15,13,0.00439774877793142#"294",15,14,0.00569818077242655#"295",15,15,0.563372516335622#"296",15,16,0.00529713624530056#"297",15,17,0.00618637632594649#"298",15,18,0.00522699653104898#"299",15,19,0.00725304454017565#"300",15,20,0.00463754113877209#"301",16,1,0.00690829177660257#"302",16,2,0.00539996539466804#"303",16,3,0.00807250681235683#"304",16,4,0.00556066339538624#"305",16,5,0.00583870907050848#"306",16,6,0.00667184612342144#"307",16,7,0.00423779472173447#"308",16,8,0.00592182833071866#"309",16,9,0.00723293450586607#"310",16,10,0.00543127883284286#"311",16,11,0.00549987082572344#"312",16,12,0.00579723320211885#"313",16,13,0.00587558417767342#"314",16,14,0.00652526469954261#"315",16,15,0.00529713624530056#"316",16,16,0.563113702999423#"317",16,17,0.00675961776601198#"318",16,18,0.0059142668819997#"319",16,19,0.00572010100019172#"320",16,20,0.00509471388929332#"321",17,1,0.00680273496060778#"322",17,2,0.00702569976095601#"323",17,3,0.00550445530594407#"324",17,4,0.0062166283456556#"325",17,5,0.00546167668674264#"326",17,6,0.00585383482376052#"327",17,7,0.00413291135580564#"328",17,8,0.00551477651378671#"329",17,9,0.00675993401280042#"330",17,10,0.00606708350752808#"331",17,11,0.00567712245217064#"332",17,12,0.00557427778144741#"333",17,13,0.00537389056722877#"334",17,14,0.00566208679067038#"335",17,15,0.00618637632594649#"336",17,16,0.00675961776601198#"337",17,17,0.557338012050392#"338",17,18,0.00602694442356467#"339",17,19,0.00680704448787803#"340",17,20,0.00498955191026114#"341",18,1,0.00663772329133235#"342",18,2,0.00534836828122324#"343",18,3,0.00549248002164443#"344",18,4,0.00530572334095195#"345",18,5,0.00560272240827403#"346",18,6,0.00468793399311048#"347",18,7,0.00394584078937318#"348",18,8,0.00496373549019806#"349",18,9,0.00484122047641801#"350",18,10,0.00545705648252963#"351",18,11,0.0052741142115203#"352",18,12,0.00789055769152605#"353",18,13,0.00598178778637268#"354",18,14,0.00628033772764367#"355",18,15,0.00522699653104898#"356",18,16,0.0059142668819997#"357",18,17,0.00602694442356467#"358",18,18,0.558810705622464#"359",18,19,0.0066158902003377#"360",18,20,0.0070168062180993#"361",19,1,0.00608776892894252#"362",19,2,0.00584183639340433#"363",19,3,0.00538155792468196#"364",19,4,0.00631745602008732#"365",19,5,0.00543160856538137#"366",19,6,0.00535158333334281#"367",19,7,0.00389477257197701#"368",19,8,0.00663464396653689#"369",19,9,0.00577312852018899#"370",19,10,0.00670591233435198#"371",19,11,0.00532964961534256#"372",19,12,0.00529659808580836#"373",19,13,0.00483101105593876#"374",19,14,0.00646437095019024#"375",19,15,0.00725304454017565#"376",19,16,0.00572010100019172#"377",19,17,0.00680704448787803#"378",19,18,0.0066158902003377#"379",19,19,0.555509918731264#"380",19,20,0.00496528806803806#"381",20,1,0.0059598457697213#"382",20,2,0.00520856029992233#"383",20,3,0.00526680603798109#"384",20,4,0.00478558272861992#"385",20,5,0.00677752367062399#"386",20,6,0.00478039580909167#"387",20,7,0.00480303542777394#"388",20,8,0.00439143299031698#"389",20,9,0.00458547473487752#"390",20,10,0.00540318329087312#"391",20,11,0.00631614004463337#"392",20,12,0.00745975649943439#"393",20,13,0.00496428406359646#"394",20,14,0.00464964617483324#"395",20,15,0.00463754113877209#"396",20,16,0.00509471388929332#"397",20,17,0.00498955191026114#"398",20,18,0.0070168062180993#"399",20,19,0.00496528806803806#"400",20,20,0.560043765818541';
function getCytoElement(data){
	var dataLine = data.split("#");
	var dataLineNum = dataLine.length;
	var nodes = [];
	var edges = [];
	var nodeTempObj={};
	var edgeTempObj={};
	for(var i=1;i<dataLineNum;i++){
		var itemArr = dataLine[i].split(",");
		var sourceNode = itemArr[1];
		var targetNode = itemArr[2];
		var weight = itemArr[3];
		if(!check(sourceNode,nodeTempObj)){
			nodes.push({"data":{"id":sourceNode,"width":80},"classes":"nodeItem"});
			nodeTempObj[sourceNode] = "nodeId";
		}
		if(!check(targetNode,nodeTempObj)){
			nodes.push({"data":{"id":targetNode,"width":80},"classes":"nodeItem"});
			nodeTempObj[targetNode] = "nodeId";
		}
		if(!check(targetNode+"_"+sourceNode,edgeTempObj)){
			edges.push({"data":{"id":sourceNode+"_"+targetNode,"source":sourceNode,"target":targetNode,"weight":weight},"classes":"edgeItem"});
			edgeTempObj[sourceNode+"_"+targetNode] = "edgeItem";
		}		
		
	}
	console.log(edgeTempObj);
	return {"nodes":nodes,"edges":edges};
}


function check(str,obj){
	if(obj[str]){
		return true;
	}else{
		return false;
	}
}
var elements = getCytoElement(data);
//draw cytoscape
function generateCy(elements){
    $("#cytoContainer").cytoscape({
        style:cytoscape.stylesheet().selector("node").css({
            'content':'data(id)',
            'width': "data(width)",
            'height':"data(width)",
            'background-fit': 'cover',
            'border-color': 'white',
            'border-width': 0,
            'border-opacity': 1
        }).selector("node.noLabel").css({
        	'content':"",
        }).selector("node.highLight").css({
        	'width':100,
        	'height':100,
        	'background-color':"red"
        }).selector("edge").css({
        	'content':"data(weight)",
            'target-arrow-shape': 'none',
            //'width': "data(weight)",
            'width': 3,
            'curve-style':"bezier",
            'control-point-step-size':20,
            'line-color':'blue'
        }).selector("edge.noLabel").css({
        	'content':"",
        }).selector("edge.highLight").css({
        	'width': 10,
        	'line-color':'red'
        }),
        elements:elements,
        layout:{
            name:"circle",
            padding:30,
            fit:true
        }
    })
    var cyto = $("#cytoContainer").cytoscape("get");
    return cyto;
}
function changeBackgound(color){
    document.getElementById("cytoContainer").style.backgroundColor = color;
}
function changeNodeColor(color){
	//var stringStylesheet = 'node { background-color: '+ color +'; }';
	//cyto.style( stringStylesheet ).update();
	cyto.nodes().style("background-color",color);
}
function changeEdgeColor(color){
	cyto.edges().style("line-color",color);
}
function changeNodeSize(nodeSize){
	cyto.nodes().style("width",nodeSize);
	cyto.nodes().style("height",nodeSize);
}
function changeEdgeWidth(edgeWidth){
	cyto.edges().style("width",edgeWidth);
}
function changeEdgeOpacity(opacity){
	cyto.edges().style("opacity",opacity);
}